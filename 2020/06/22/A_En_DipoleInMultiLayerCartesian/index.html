<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><title>Dipole's Emission In Multi-Layered  Structure | KnifeLee's Personal Blog</title><meta name="description" content="Dipole's Emission In Multi-Layered  Structure"><meta name="keywords" content="Python,Physics"><meta name="author" content="Knifelee"><meta name="copyright" content="Knifelee"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="preconnect" href="//cdn.jsdelivr.net"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:title" content="Dipole's Emission In Multi-Layered  Structure"><meta name="twitter:description" content="Dipole's Emission In Multi-Layered  Structure"><meta name="twitter:image" content="https://raw.githubusercontent.com/knifelees3/my_pictures/master/picgoup/20200223215829792_1734.jpg"><meta property="og:type" content="article"><meta property="og:title" content="Dipole's Emission In Multi-Layered  Structure"><meta property="og:url" content="https://knifelees3.github.io/2020/06/22/A_En_DipoleInMultiLayerCartesian/"><meta property="og:site_name" content="KnifeLee's Personal Blog"><meta property="og:description" content="Dipole's Emission In Multi-Layered  Structure"><meta property="og:image" content="https://raw.githubusercontent.com/knifelees3/my_pictures/master/picgoup/20200223215829792_1734.jpg"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>const autoChangeMode = 'false'
var t = Cookies.get("theme");
if (autoChangeMode == '1'){
const isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
const isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
const isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

if (t === undefined){
  if (isLightMode) activateLightMode()
  else if (isDarkMode) activateDarkMode()
  else if (isNotSpecified || hasNoSupport){
    console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
    now = new Date();
    hour = now.getHours();
    isNight = hour < 6 || hour >= 18
    isNight ? activateDarkMode() : activateLightMode()
}
} else if (t == 'light') activateLightMode()
else activateDarkMode()


} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="https://knifelees3.github.io/2020/06/22/A_En_DipoleInMultiLayerCartesian/"><link rel="next" title="win10 按百分比显示电量的图标软件" href="/https:/knifelees3.github.io/2020/06/21/C_%E6%95%99%E7%A8%8B_%E5%A6%82%E4%BD%95%E8%AE%A9win10%E7%94%B5%E8%84%91%E6%8C%89%E7%99%BE%E5%88%86%E6%AF%94%E6%98%BE%E7%A4%BA%E7%94%B5%E9%87%8F/"><link rel="dns-prefetch" href="https://hm.baidu.com"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?7c4710045c846acddf6f6813e3d1fa3e";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  highlight_copy: 'true',
  highlight_lang: 'false',
  highlight_shrink: 'false',
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  bookmark: {
    title: 'Snackbar.bookmark.title',
    message_prev: 'Press',
    message_next: 'to bookmark this page'
  },
  runtime_unit: 'days',
  copyright: undefined,
  copy_copyright_js: false,
  ClickShowText: {"text":"富强,民主,文明,和谐,自由,平等,公正,法治,爱国,敬业,诚信,友善","fontSize":"15px"},
  medium_zoom: 'false',
  Snackbar: undefined
  
}</script></head><body><div id="header"> <div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">KnifeLee's Personal Blog</a></span><i class="fa fa-bars fa-fw toggle-menu pull_right close" aria-hidden="true"></i><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> About</span></a></div></div></span><span class="pull_right" id="search_button"><a class="site-page social-icon search"><i class="fa fa-search fa-fw"></i><span> Search</span></a></span></div></div><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="lazyload avatar_img" src="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'"></div><div class="mobile_post_data"><div class="mobile_data_item is_center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">Articles</div><div class="length_num">59</div></a></div></div><div class="mobile_data_item is_center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">Tags</div><div class="length_num">29</div></a></div></div><div class="mobile_data_item is_center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">Categories</div><div class="length_num">6</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> About</span></a></div></div></div><div id="mobile-sidebar-toc"><div class="toc_mobile_headline">Catalog</div><ol class="toc_mobile_items"><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#Introduction"><span class="toc_mobile_items-number">1.</span> <span class="toc_mobile_items-text">Introduction</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#Extra-words"><span class="toc_mobile_items-number">1.1.</span> <span class="toc_mobile_items-text">Extra words</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#Green-tensor-expression"><span class="toc_mobile_items-number">2.</span> <span class="toc_mobile_items-text">Green tensor expression</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#In-the-upper-space"><span class="toc_mobile_items-number">2.1.</span> <span class="toc_mobile_items-text">In the upper space</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#In-the-lower-space"><span class="toc_mobile_items-number">2.2.</span> <span class="toc_mobile_items-text">In the lower space</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#The-field-expression-and-emission-pattern"><span class="toc_mobile_items-number">3.</span> <span class="toc_mobile_items-text">The field expression and emission pattern</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#Numerical-Implementation"><span class="toc_mobile_items-number">4.</span> <span class="toc_mobile_items-text">Numerical Implementation</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#In-the-upper-space-1"><span class="toc_mobile_items-number">4.1.</span> <span class="toc_mobile_items-text">In the upper space</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#In-the-lower-space-1"><span class="toc_mobile_items-number">4.2.</span> <span class="toc_mobile_items-text">In the lower space</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#Relations-of-amplitudes-in-different-layers"><span class="toc_mobile_items-number">5.</span> <span class="toc_mobile_items-text">Relations of amplitudes in different layers</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#S-polarized-light-upper-lower-layer"><span class="toc_mobile_items-number">5.1.</span> <span class="toc_mobile_items-text">S polarized light upper/lower layer</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#P-polarized-light-upper-lower-layer"><span class="toc_mobile_items-number">5.2.</span> <span class="toc_mobile_items-text">P polarized light upper/lower layer</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#S-polarized-light"><span class="toc_mobile_items-number">5.2.1.</span> <span class="toc_mobile_items-text">S polarized light</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#P-polarized-light"><span class="toc_mobile_items-number">5.2.2.</span> <span class="toc_mobile_items-text">P polarized light.</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#Appendix"><span class="toc_mobile_items-number">5.3.</span> <span class="toc_mobile_items-text">Appendix</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#Dyadic-Analysis"><span class="toc_mobile_items-number">5.3.1.</span> <span class="toc_mobile_items-text">Dyadic Analysis</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#Reference"><span class="toc_mobile_items-number">5.4.</span> <span class="toc_mobile_items-text">Reference</span></a></li></ol></li></ol></div></div><div id="body-wrap"><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true">     </i><div class="auto_open" id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Introduction"><span class="toc-number">1.</span> <span class="toc-text">Introduction</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Extra-words"><span class="toc-number">1.1.</span> <span class="toc-text">Extra words</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Green-tensor-expression"><span class="toc-number">2.</span> <span class="toc-text">Green tensor expression</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#In-the-upper-space"><span class="toc-number">2.1.</span> <span class="toc-text">In the upper space</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#In-the-lower-space"><span class="toc-number">2.2.</span> <span class="toc-text">In the lower space</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#The-field-expression-and-emission-pattern"><span class="toc-number">3.</span> <span class="toc-text">The field expression and emission pattern</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Numerical-Implementation"><span class="toc-number">4.</span> <span class="toc-text">Numerical Implementation</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#In-the-upper-space-1"><span class="toc-number">4.1.</span> <span class="toc-text">In the upper space</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#In-the-lower-space-1"><span class="toc-number">4.2.</span> <span class="toc-text">In the lower space</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Relations-of-amplitudes-in-different-layers"><span class="toc-number">5.</span> <span class="toc-text">Relations of amplitudes in different layers</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#S-polarized-light-upper-lower-layer"><span class="toc-number">5.1.</span> <span class="toc-text">S polarized light upper/lower layer</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#P-polarized-light-upper-lower-layer"><span class="toc-number">5.2.</span> <span class="toc-text">P polarized light upper/lower layer</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#S-polarized-light"><span class="toc-number">5.2.1.</span> <span class="toc-text">S polarized light</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#P-polarized-light"><span class="toc-number">5.2.2.</span> <span class="toc-text">P polarized light.</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Appendix"><span class="toc-number">5.3.</span> <span class="toc-text">Appendix</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Dyadic-Analysis"><span class="toc-number">5.3.1.</span> <span class="toc-text">Dyadic Analysis</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reference"><span class="toc-number">5.4.</span> <span class="toc-text">Reference</span></a></li></ol></li></ol></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://raw.githubusercontent.com/knifelees3/my_pictures/master/picgoup/20200223215829792_1734.jpg)"><div id="post-info"><div id="post-title"><div class="posttitle">Dipole's Emission In Multi-Layered  Structure</div></div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> Created 2020-06-22<span class="post-meta__separator">|</span><i class="fa fa-history" aria-hidden="true"></i> Updated 2020-06-22</time><span class="post-meta__separator mobile_hidden">|</span><span class="mobile_hidden"><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/Physics/">Physics</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/Physics/EnglishNotes/">EnglishNotes</a></span><div class="post-meta-wordcount"><i class="fa fa-file-word-o post-meta__icon" aria-hidden="true"></i><span>Word count: </span><span class="word-count">6.6k</span><span class="post-meta__separator">|</span><i class="fa fa-clock-o post-meta__icon" aria-hidden="true"></i><span>Reading time: 41 min</span><span class="post-meta__separator">|</span><i class="fa fa-eye post-meta__icon" aria-hidden="true">       </i><span>Post View: </span><span id="busuanzi_value_page_pv"></span></div></div></div></div><div class="layout layout_post" id="content-inner">   <article id="post"><div class="article-container" id="post-content"><h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>This is the note of dipole radiation pattern calculations in a multilayer structure. </p>
<p>The numerical realizations can be found in my <a href="https://github.com/knifelees3/DipoleEmissionInSymmetricStructure" target="_blank" rel="noopener">Github</a>.</p>
<p>The derivations mainly follow the work of Olivier J. F et .al <sup><a href="#fn_ref1" id="reffn_ref1">ref1</a></sup></p>
<h2 id="Extra-words"><a href="#Extra-words" class="headerlink" title="Extra words"></a>Extra words</h2><p>My previous calculations are not helpful since we can not get the emission pattern. In previous cylindrical expressions, the integral in $\mathrm{d}k_{\phi}$ has been transformed into Bessel functions via</p>
<script type="math/tex; mode=display">
J_{n}(k_{\rho}\rho)=\frac{j^{-n}}{2\pi}\int_{0}^{2\pi}\mathrm{d}k_{\phi}\exp (jk_{\rho}\rho\cos k_\phi)cos(nk_\phi)</script><p>If we extract the information of $\mathrm{d}k_{\phi}$, our previous expressions can also be used to get the emission pattern. However, to make this easier to understand, we use plane waves to expand Green’s tensor.</p>
<h1 id="Green-tensor-expression"><a href="#Green-tensor-expression" class="headerlink" title="Green tensor expression"></a>Green tensor expression</h1><p>We will use Green tensor to get the dipole’s emission!</p>
<p><img alt data-src="https://raw.githubusercontent.com/knifelees3/my_pictures/master/picgoup/20200223215829792_1734.jpg" class="lazyload"></p>
<p>I will follow the derivations of Paulus et. al . The derivations will begin from the expression of the Green’s tensor. We still consider only the nonmagnetic material so $\mu=1$ and we use $\mu=\mu_0$ to express the permeability in the vacuum. The equation of the Green’s tensor is as follows</p>
<script type="math/tex; mode=display">
\boldsymbol{\nabla}\times\boldsymbol{\nabla}\times \boldsymbol{\overset\leftrightarrow{G}}(\boldsymbol{r},\boldsymbol{r}_0)-k_0^2\varepsilon\mu\boldsymbol{\nabla}\times \boldsymbol{\overset\leftrightarrow{G}}(\boldsymbol{r},\boldsymbol{r}_0)=\boldsymbol{I}\delta(\boldsymbol{r}-\boldsymbol{r}_0)</script><p>and for a homogeneous media the Green’s tensor can be expressed as</p>
<script type="math/tex; mode=display">
\boldsymbol{\overset\leftrightarrow{G}}(\boldsymbol{r},\boldsymbol{r}_0)=\left(1+\frac{\boldsymbol{\nabla}\boldsymbol{\nabla}}{k_B^2}\right)\frac{\exp (jk_BR)}{4\pi R}</script><p>where $R=|\boldsymbol{R}|=|\boldsymbol{r-r_0}|$ is the relative distance and $k_{B}^2=\omega^2\varepsilon \mu$ corresponds to the wave number in the background medium. We can do Fourier transform of Green’s tensor as</p>
<script type="math/tex; mode=display">
\begin{aligned}
    \boldsymbol{\overset\leftrightarrow{G}}(k)&=\iiint_{-\infty}^{\infty}\boldsymbol{\overset\leftrightarrow{G}}(\boldsymbol{r},\boldsymbol{r}_0)\exp(-j\boldsymbol{k}\cdot\boldsymbol{R})\mathrm{d}\boldsymbol{R}\\
    &=\iiint_{-\infty}^{\infty}\left(1+\frac{\boldsymbol{\nabla}\boldsymbol{\nabla}}{k_B^2}\right)\frac{\exp (jk_BR)}{4\pi R} \exp(-j\boldsymbol{k}\cdot\boldsymbol{R})\mathrm{d}\boldsymbol{R}\\
 \end{aligned}</script><p>and we can express the Green’s tensor as a Fourier transform of each wavevector,</p>
<script type="math/tex; mode=display">
\boldsymbol{\overset\leftrightarrow{G}}(\boldsymbol{r},\boldsymbol{r}_0)=\frac{1}{8\pi^3k_B^2}\iiint \mathrm{d} \mathbf{k}\left(\frac{\boldsymbol{1}k_B^2-\boldsymbol{\mathrm{k}}\boldsymbol{\mathrm{k}}}{k^2-k_B^2}\right)\exp (j\boldsymbol{\mathrm{k}} \boldsymbol{\cdot R})</script><p>Since we assume that the layers, which will be added later, are perpendicular to the z axis, we first perform the integration over $k_z$ using calculus of residues. Hence, we muse ensure that the integrand vanishes for $k_z\rightarrow\infty$ and rewrite as</p>
<script type="math/tex; mode=display">
\begin{aligned}
\mathbf{G}\left(\mathbf{r}, \mathbf{r}_0\right)=& \frac{1}{8 \pi^{3} k_{B}^{2}} \iiint \mathrm{d} \mathbf{k}\left(\frac{\mathbf{1} k_{B}^{2}-\mathbf{k} \mathbf{k}}{k^{2}-k_{B}^{2}}+\hat{\mathbf{z}} \hat{\mathbf{z}}\right) \exp (j \mathbf{k} \cdot \mathbf{R}) \\
&-\frac{\hat{\mathbf{z}} \hat{\mathbf{z}}}{8 \pi^{3} k_{B}^{2}} \iint \mathrm{d} \mathbf{k} \exp (i \mathbf{k} \cdot \mathbf{R}) \\
=& \frac{j}{8 \pi^{2} k_{B}^{2}} \iint \mathrm{d} k_{x} \mathrm{d} k_{y}\left(\frac{\mathbf{1} k_{B}^{2}-\mathbf{k}_{B}\mathbf{k}_{B}}{k_{B z}}\right) \\
 & \times \exp \left(j \mathbf{k}_{B} \cdot \mathbf{R}\right)-\frac{\hat{\mathbf{z}} \hat{\mathbf{z}}}{k_{B}^{2}} \delta(\mathbf{R}) 
 \end{aligned}</script><p>where $k_{Bz}=\sqrt{k_B^2-k_x^2-k_y^2}$ is the z component of the wave vector and $\boldsymbol{z}$</p>
<script type="math/tex; mode=display">
\boldsymbol{\mathrm{k}}_B(k_{Bz})=\left\{ \begin{aligned}
k_x\boldsymbol{\hat{x}}+k_y\boldsymbol{\hat{y}}+k_z\boldsymbol{\hat{z}} \quad \text{for} \quad z > z_0,\\
k_x\boldsymbol{\hat{x}}+k_y\boldsymbol{\hat{y}}-k_z\boldsymbol{\hat{z}} \quad \text{for} \quad z < z_0,
\end{aligned}\right.</script><p>Now that we have the plane-wave expansion of the Green’s tensor for an infinite homogeneous background. It is a simple matter to include additional layers. Indeed, the effect of these layers will be to add two plane waves, one propagating upward and one downward, to each Fourier component, The amplitudes of these additional components are determined by the boundary conditions at the different interfaces. Since the Green’s tensor represents the electric field radiated at $r$ by three orthogonal point sources at $r’$, the boundary conditions depend on the polarization of the corresponding Fourier component. It is therefore advantageous to introduce a new orthonormal system<br>$\boldsymbol{\mathrm{\hat{k}}}(k_{Bz}),\boldsymbol{\mathrm{\hat{I}}}(k_{Bz}),\boldsymbol{\mathrm{\hat{m}}}(k_{Bz})$</p>
<script type="math/tex; mode=display">
\boldsymbol{\mathrm{\hat{k}}}(k_{Bz})=\frac{\boldsymbol{\mathrm{k}}(k_{Bz})}{k_B}=(\hat{k}_x(k_{Bz}),\hat{k}_y(k_{Bz}),\hat{k}_z(k_{Bz}))</script><script type="math/tex; mode=display">
\boldsymbol{\mathrm{\hat{I}}}(k_{Bz})=\frac{\boldsymbol{\mathrm{\hat{k}}}(k_{Bz})\times \boldsymbol{\hat{z}}}{|\boldsymbol{\mathrm{\hat{k}}}(k_{Bz})\times \boldsymbol{\hat{z}}|}=(\hat{k}_y(k_{Bz}),-\hat{k}_x(k_{Bz}),0)</script><script type="math/tex; mode=display">
\boldsymbol{\mathrm{\hat{m}}}(k_{Bz})=\boldsymbol{\mathrm{\hat{k}}}(k_{Bz})\times\boldsymbol{\mathrm{\hat{I}}}(k_{Bz})=\left(\hat{k}_x(k_{Bz})\hat{k}_z(k_{Bz}),\hat{k}_y(k_{Bz})\hat{k}_z(k_{Bz}),-\left[\hat{k}_x^2(k_{Bz})+\hat{k}_y^2(k_{Bz})\right]\right)</script><p>Equivalently, another orthogonal system is formed by $\boldsymbol{\mathrm{\hat{k}}}(-k_{Bz}),\boldsymbol{\mathrm{\hat{I}}}(-k_{Bz}),\boldsymbol{\mathrm{\hat{m}}}(-k_{Bz})$. Remark that $\boldsymbol{\mathrm{\hat{I}}}$ is perpendicular to the plane<br>defined by $\boldsymbol{\mathrm{\hat{k}}}$ and $\boldsymbol{\mathrm{\hat{z}}}$, whereas $\boldsymbol{\mathrm{\hat{m}}}$ lies within this plane. For a given $k_B$, the electric field component parallel to $\boldsymbol{\mathrm{\hat{I}}}$ corresponds<br>to s polarization and that parallel to $\boldsymbol{\mathrm{\hat{m}}}$ corresponds to p polarization, using the fact that</p>
<script type="math/tex; mode=display">
\boldsymbol{\mathrm{\hat{k}}}\boldsymbol{\mathrm{\hat{k}}}+\boldsymbol{\mathrm{\hat{I}}}\boldsymbol{\mathrm{\hat{I}}}+\boldsymbol{\mathrm{\hat{m}}}\boldsymbol{\mathrm{\hat{m}}}=\boldsymbol{\mathrm{1}}</script><p>we can rewrite the Green’s tensor as</p>
<script type="math/tex; mode=display">
\mathbf{G}\left(\mathbf{r}, \mathbf{r}^{\prime}\right)=-\frac{\hat{\mathbf{z}} \hat{\mathbf{z}}}{k_{B}^{2}} \delta(\mathbf{R})+\frac{j}{8\pi^2}\iint \mathrm{d} k_{x} \mathrm{d} k_{y}\left(\frac{\boldsymbol{\mathrm{\hat{I}}}\boldsymbol{\mathrm{\hat{I}}}+\boldsymbol{\mathrm{\hat{m}}}\boldsymbol{\mathrm{\hat{m}}}}{k_{Bz}}\right)\times \exp (j\boldsymbol{\mathrm{k}} \boldsymbol{\cdot R})</script><p>To obtain the Green’s tensor $\mathbf{G}\left(\mathbf{r}, \mathbf{r}^{\prime}\right)$ for a stratified medium, we can now superpose to the free-space Green’s tensor of a homogeneous medium $\varepsilon_l$ the additional terms by  formally writing</p>
<script type="math/tex; mode=display">
\begin{aligned} 
    \mathbf{G}\left(\mathbf{r}, \mathbf{r}^{\prime}\right)=&-\frac{\hat{\mathbf{z}} \hat{\mathbf{z}}}{k_{l}^{2}} \delta(\mathbf{R})+\frac{i}{8 \pi^{2}} \iint \mathrm{d} k_{x} \mathrm{d} k_{y} \exp \left\{j\left[k_{x}\left(x-x_0\right)+k_{y}\left(y-y_0\right)\right]\right\}\frac{1}{k_{l z}}\\
    &\left[\hat{\mathbf{I}}\hat{\mathbf{I}} \exp \left(j k_{l z}\left|z-z_0\right|\right)+\mathbf{R}^{s \uparrow} \exp \left(i k_{l z} z\right)+\mathbf{R}^{s \downarrow} \exp \left(-j k_{l z} z\right)\right.\\
    &\left.+\hat{\mathbf{m}}\hat{\mathbf{m}} \exp \left(j k_{l z}\left|z-z_0 \right|\right)+\mathbf{R}^{p \uparrow} \exp \left(i k_{l z} z\right)+\mathbf{R}^{p \downarrow} \exp \left(-j k_{l z} z\right)\right]
    \end{aligned}</script><p>where $k_{l}^2=\omega^2\varepsilon_l\mu_l$ and $k_{lz}=\sqrt{k_l^2-k_x^2-k_y^2}$. The tensors $\mathbf{R}^{s \uparrow},\mathbf{R}^{s \downarrow},\mathbf{R}^{p \uparrow},\mathbf{R}^{p \downarrow}$ can obviously be interpreted as generalized reflection coefficients that take into account reflections from all existing surfaces. For the explicit calculation of $\mathbf{G}\left(\mathbf{r}, \mathbf{r}^{\prime}\right)$ it is necessary to consider separately the two cases $z&gt;z_0$ and $z&lt;z_0$. each component of the Green’s tensor is expressed in terms of s- and p-polarized upgoing and down going plane waves with amplitude coefficients $A_{l,\alpha\beta}^{s/p},B_{l,\alpha\beta}^{s/p}$</p>
<script type="math/tex; mode=display">
\begin{aligned} G_{\alpha \beta}\left(\mathbf{r}, \mathbf{r}^{\prime}\right)=& \frac{j}{8 \pi^{2}} \iint \mathrm{d} k_{x} \mathrm{d} k_{y} \exp \left\{j\left[k_{x}\left(x-x^{\prime}\right)\right.\right.\\ &\left.\left.+k_{y}\left(y-y^{\prime}\right)\right]\right\} \frac{1}{k_{l z}}\left\{\left[\hat{l}_{\alpha}\left( \pm k_{l z}\right) A_{l, \alpha \beta}^{s} \exp \left(j k_{l z} z\right)\right.\right.\\ &\left.+\hat{l}_{\alpha}\left(\mp k_{l z}\right) B_{l, \alpha \beta}^{s} \exp \left(-j k_{l z} z\right)\right] \hat{l}_{\beta}\left(k_{l z}\right) \\ &+\left[\hat{m}_{\alpha}\left( \pm k_{l z}\right) A_{l, \alpha \beta}^{p} \exp \left(j k_{l z} z\right)\right.\\ &\left.\left.+\hat{m}_{\alpha}\left(\mp k_{l z}\right) B_{l, \alpha \beta}^{p} \exp \left(-j k_{l z} z\right)\right] \hat{m}_{\beta}\left(k_{l z}\right)\right\} \end{aligned}
 \label{Galphabeta}</script><p>We need express each component of the Green’s tensor and then we can write the field distribution for an arbitrary orientate dipole. And the coefficients can be obtained from the outer layer to the emitting layer. It’s necessary for us to write the explict form of the Green tensor. We write the Green tensor as</p>
<script type="math/tex; mode=display">
G_{\alpha \beta}\left(\mathbf{r}, \mathbf{r}^{\prime}\right)=\frac{j}{8 \pi^{2}}\iint \mathrm{d} k_{x} \mathrm{d} k_{y} \exp \left\{j\left[k_{x}\left(x-x^{\prime}\right)+k_{y}\left(y-y^{\prime}\right)\right]\right\} \frac{1}{k_{l z}}\left[f_{\alpha,\beta}^s+f_{\alpha,\beta}^p\right]</script><p>We need write the explicit form of the tensor,</p>
<script type="math/tex; mode=display">
1-\boldsymbol{\mathrm{\hat{k}}}\boldsymbol{\mathrm{\hat{k}}}=\frac{1}{k_{l}^{2} }\left[\begin{array}{ccc}{k_{l}^{2}-k_{x}^{2}} & {-k_{x} k_{y}} & {\mp k_{x} k_{lz}} \\ {-k_{x} k_{y}} & {k_{l}^{2}-k_{y}^{2}} & {\mp k_{y} k_{lz}} \\ {\mp k_{x} k_{lz}} & {\mp k_{y} k_{lz}} & {k_{l}^{2}-k_{lz}^{2}}\end{array}\right]</script><p>and</p>
<script type="math/tex; mode=display">
\boldsymbol{\mathrm{\hat{I}}}\boldsymbol{\mathrm{\hat{I}}}=\frac{1}{\left(k_{x}^{2}+k_{y}^{2}\right)}\left[\begin{array}{ccc}{k_{y}^{2}} & {-k_{x} k_{y}} & {0} \\ {-k_{x} k_{y}} & {k_{x}^{2}} & {0} \\ {0} & {0} & {0}\end{array}\right]</script><script type="math/tex; mode=display">
\boldsymbol{\mathrm{\hat{m}}}\boldsymbol{\mathrm{\hat{m}}}=\frac{1}{k_{l}^{2}\left(k_{x}^{2}+k_{y}^{2}\right)}\left[\begin{array}{ccc}{k_{x}^{2} k_{lz}^2} & {k_{x} k_{y} k_{lz}^2} & {\mp k_{x}k_{lz}\left(k_{x}^{2}+k_{y}^{2}\right)} \\ {k_{x} k_{y} k_{lz}^2} & {k_{y}^{2} k_{lz}^2} & {\mp k_{lz}k_{y}\left(k_{x}^{2}+k_{y}^{2}\right)} \\ {\mp k_{x}k_{lz}\left(k_{x}^{2}+k_{y}^{2}\right)} & {\mp k_{lz} k_{y}\left(k_{x}^{2}+k_{y}^{2}\right)} & {\left(k_{x}^{2}+k_{y}^{2}\right)^{2}}\end{array}\right]</script><p>Since the definition in the [] let the sign attached to $A_l,B_{l}$, then</p>
<script type="math/tex; mode=display">
\boldsymbol{f^s}=\frac{1}{\left(k_{x}^{2}+k_{y}^{2}\right)}\left[\begin{array}{ccc}{k_{y}^{2}} & {-k_{x} k_{y}} & {0} \\ {-k_{x} k_{y}} & {k_{x}^{2}} & {0} \\ {0} & {0} & {0}\end{array}\right]\odot \left(\boldsymbol{A}_{l}^s\exp(jk_{lz}z))+\boldsymbol{B}_{l}^s\exp(-jk_{lz}z)\right)</script><script type="math/tex; mode=display">
\begin{aligned}
    \boldsymbol{f^p}&=\frac{1}{k_{l}^{2}\left(k_{x}^{2}+k_{y}^{2}\right)}\left[\begin{array}{ccc}{\pm k_{x}^{2} k_{lz}^2} & \pm {k_{x} k_{y} k_{lz}^2} & \mp{k_{x}k_{lz}\left(k_{x}^{2}+k_{y}^{2}\right)} \\ 
    \pm {k_{x} k_{y} k_{lz}^2} & \pm {k_{y}^{2} k_{lz}^2} & \mp{ k_{y}k_{lz}\left(k_{x}^{2}+k_{y}^{2}\right)} \\ 
    { - k_{x}k_{lz}\left(k_{x}^{2}+k_{y}^{2}\right)} & - { k_{y}k_{lz}\left(k_{x}^{2}+k_{y}^{2}\right)} &  {\left(k_{x}^{2}+k_{y}^{2}\right)^{2} }\end{array}\right]\odot \boldsymbol{A}_{l}^p\exp(jk_{lz}z))\\
    &+\frac{1}{k_{l}^{2}\left(k_{x}^{2}+k_{y}^{2}\right)}\left[\begin{array}{ccc}{\mp k_{x}^{2} k_{lz}^2} & \mp {k_{x} k_{y} k_{lz}^2} & \pm{k_{x}k_{lz}\left(k_{x}^{2}+k_{y}^{2}\right)} \\
     \mp {k_{x} k_{y} k_{lz}^2} & \mp {k_{y}^{2} k_{lz}^2} & \pm{ k_{y}k_{lz}\left(k_{x}^{2}+k_{y}^{2}\right)} \\ 
    { - k_{x}k_{lz}\left(k_{x}^{2}+k_{y}^{2}\right)} & - { k_{y}k_{lz}\left(k_{x}^{2}+k_{y}^{2}\right)} &  {\left(k_{x}^{2}+k_{y}^{2}\right)^{2} }\end{array}\right]\odot \boldsymbol{B}_{l}^p\exp(-jk_{lz}z)
\end{aligned}</script><p>Here $\odot$ means the multiply of the corresponding elements in each matrix. We now need calculate the accurate expression of the $A_{\alpha,\beta}^{s/p},A_{\alpha,\beta}^{s/p}$, in the emitting layer $A_{\alpha,\beta}^{s/p},A_{\alpha,\beta}^{s/p}$ should include the dipole’s background part and the reflecting part from other layers. The total reflection coefficients can be calculated iteratively from the outer layer. For the p polarization, for $\beta \neq z$</p>
<script type="math/tex; mode=display">
A_{0,\alpha \beta}^{p\uparrow/\downarrow}=\pm R^{p\downarrow}_{0,\alpha\beta}\frac{R^{p\uparrow}_{0,\alpha\beta}\exp(-jk_{0z}z_0)-\exp(jk_{0z}z_0)}{1-R^{p\downarrow}_{0,\alpha\beta}R^{p\uparrow}_{0,\alpha\beta}}\pm\Theta(z-z_0)\exp(-jk_{0z}z_0)</script><script type="math/tex; mode=display">
B_{l,\alpha \beta}^{p\uparrow/\downarrow}=\mp R^{p\uparrow}_{0,\alpha\beta}\frac{R^{p\downarrow}_{0,\alpha\beta}\exp(jk_{0z}z_0)-\exp(-jk_{0z}z_0)}{1-R^{p\downarrow}_{0,\alpha\beta}R^{p\uparrow}_{0,\alpha\beta}}\mp \Theta(z_0-z)\exp(jk_{0z}z_0)</script><p>with $\beta=z$</p>
<script type="math/tex; mode=display">
A_{l,\alpha \beta}^{p\uparrow/\downarrow}= R^{p\downarrow}_{0,\alpha\beta}\frac{R^{p\uparrow}_{0,\alpha\beta}\exp(-jk_{0z}z_0)+\exp(jk_{0z}z_0)}{1-R^{p\downarrow}_{0,\alpha\beta}R^{p\uparrow}_{0,\alpha\beta}}+\Theta(z-z_0)\exp(-jk_{0z}z_0)</script><script type="math/tex; mode=display">
B_{l,\alpha \beta}^{p\uparrow/\downarrow}= R^{p\uparrow}_{0,\alpha\beta}\frac{R^{p\downarrow}_{0,\alpha\beta}\exp(jk_{0z}z_0)+\exp(-jk_{0z}z_0)}{1-R^{p\downarrow}_{0,\alpha\beta}R^{p\uparrow}_{0,\alpha\beta}}+ \Theta(z_0-z)\exp(jk_{0z}z_0)</script><p>For the s polarization</p>
<script type="math/tex; mode=display">
A_{l,\alpha \beta}^{s\uparrow/\downarrow}= R^{s\downarrow}_{0,\alpha\beta}\frac{R^{s\uparrow}_{0,\alpha\beta}\exp(-jk_{0z}z_0)+\exp(jk_{0z}z_0)}{1-R^{s\downarrow}_{0,\alpha\beta}R^{s\uparrow}_{0,\alpha\beta}}+\Theta (z-z_0)\exp(-jk_{0z}z_0)</script><script type="math/tex; mode=display">
B_{l,\alpha \beta}^{s\uparrow/\downarrow}= R^{s\uparrow}_{0,\alpha\beta}\frac{R^{s\downarrow}_{0,\alpha\beta}\exp(jk_{0z}z_0)+\exp(-jk_{0z}z_0)}{1-R^{s\downarrow}_{0,\alpha\beta}R^{s\uparrow}_{0,\alpha\beta}}+ \Theta (z_0-z)\exp(jk_{0z}z_0)</script><p>In above expressions, $R^{s/p,\uparrow\downarrow}$ are the total reflections in the emitting layer, we define the reflection coefficients in the upper space for each interface as</p>
<script type="math/tex; mode=display">
R_{l,\alpha\beta}^{p\uparrow}=\frac{B_{l,\alpha\beta}^{p\uparrow}}{A_{l,\alpha\beta}^{p\uparrow}},R_{l,\alpha\beta}^{s\uparrow}=\frac{B_{l,\alpha\beta}^{s\uparrow}}{A_{l,\alpha\beta}^{s\uparrow}}</script><p>the same with the lower space</p>
<script type="math/tex; mode=display">
R_{l}^{p\downarrow}=\frac{A_{l}^{p\downarrow}}{B_{l}^{p\downarrow}},R_{l}^{s\downarrow}=\frac{A_{l}^{s\downarrow}}{B_{l}^{s\downarrow}}</script><p>the reflections can be calculated iteratively from the outer layer</p>
<script type="math/tex; mode=display">
R_{l,\alpha\beta}^{s/p,\uparrow}=\frac{R_{l+1,\alpha\beta}^{s/p,\uparrow}e^{-j(k_{(l+1)z}-k_{lz})d_{l+1}}+R_{l(l+1)}^{s/p}e^{j(k_{(l+1)z}+k_{lz})d_{l+1}}}{R_{l+1,\alpha\beta}^{s/p,\uparrow}R_{l(l+1)}^{s/p}e^{-j(k_{(l+1)z}+k_{lz})d_{l+1}}+e^{j(k_{(l+1)z}-k_{lz})d_{l+1}}}</script><script type="math/tex; mode=display">
R_{l,\alpha\beta}^{s/p,\downarrow}=\frac{R_{l-1,\alpha\beta}^{s/p,\downarrow}e^{j(k_{(l-1)z}-k_{lz})d_{l}}+R_{l(l-1)}^{s/p}e^{-j(k_{(l-1)z}+k_{lz})d_{l}}}{R_{l-1,\alpha\beta}^{s/p,\downarrow}R_{l(l-1)}^{s/p}e^{j(k_{(l-1)z}+k_{lz})d_{l}}+e^{-j(k_{(l-1)z}-k_{lz})d_{l}}}</script><p>where</p>
<script type="math/tex; mode=display">
R_{l(l-1)}^{p}=\frac{\varepsilon_{l-1} k_{l z}-\varepsilon_{l} k_{l-1, z}}{\varepsilon_{l} k_{(l-1) z}+\varepsilon_{l-1} k_{l z}}=-R_{(l-1) l}^{p} \quad R_{l(l-1)}^{s}=\frac{k_{l z}-k_{(l-1) z}}{k_{(l-1) z}+k_{l z}}=-R_{(l-1) l}^{s}</script><p>and</p>
<script type="math/tex; mode=display">
T_{l(l-1)}^{p}=\frac{2\varepsilon_{l-1} k_{l z}}{\varepsilon_{l} k_{(l-1) z}+\varepsilon_{l-1} k_{l z}}=1+R_{l(l-1) }^{p} \quad T_{l(l-1)}^{s}=\frac{2k_{l z}}{k_{(l-1) z}+k_{l z}}=1+R_{l(l-1)}^{s}</script><p>So we can calculate the coefficients in the emitting layer, and the coefficients in other can be calculated via the transmission matrix.</p>
<h2 id="In-the-upper-space"><a href="#In-the-upper-space" class="headerlink" title="In the upper space"></a>In the upper space</h2><script type="math/tex; mode=display">
A_{l+1,\alpha\beta}^{s/p}=\gamma^{s/p}\left[A_{l,\alpha\beta}^{s/p}e^{j(k_{lz}-k_{(l+1)z})d_{l+1}}+R_{(l+1)l}^{s/p}B_{l,\alpha\beta}^{s/p} e^{-j(k_{lz}+k_{(l+1)z})d_{l+1}}\right]</script><script type="math/tex; mode=display">
B_{l+1,\alpha\beta}^{s/p}=\gamma^{s/p}\left[R_{(l+1)l}^{s/p}A_{l,\alpha\beta}^{s/p}e^{j(k_{lz}+k_{(l+1)z})d_{l+1}}+B_{l,\alpha\beta}^{s/p} e^{-j(k_{lz}-k_{(l+1)z})d_{l+1}}\right]</script><p>where</p>
<script type="math/tex; mode=display">
\gamma^{s}=\frac{1}{2}\frac{k_{lz}+k_{(l+1)z}}{k_{lz}}=\frac{1}{1-R^{s}_{(l+1)l}}</script><script type="math/tex; mode=display">
\gamma^{p}=\frac{1}{2}\frac{k_{lz}\varepsilon_{l+1}+\varepsilon_{l}k_{(l+1)z}}{k_{(l+1)z}\varepsilon_{l}}=\frac{1}{1+R^{p}_{(l+1)l}},\quad \text {for } \quad \beta=x,y,\quad\alpha=x,y,z</script><script type="math/tex; mode=display">
\gamma^{p}=\frac{1}{2}\frac{k_{lz}\varepsilon_{l+1}+\varepsilon_{l}k_{lz}}{k_{lz}\varepsilon_{l+1}}=\frac{k_{(l+1)z}}{k_{lz}}\frac{1}{1+R^{p}_{(l+1)l}},\quad \text {for } \quad \beta=z, \quad\alpha=x,y,z</script><h2 id="In-the-lower-space"><a href="#In-the-lower-space" class="headerlink" title="In the lower space"></a>In the lower space</h2><script type="math/tex; mode=display">
A_{l-1,\alpha\beta}^{s/p}=\gamma^{s/p}\left[A_{l,\alpha\beta}^{s/p}e^{j(k_{lz}-k_{(l-1)z})d_{l}}+R_{(l-1)l}^{s/p}B_{l,\alpha\beta}^{s/p} e^{-j(k_{lz}+k_{(l-1)z})d_{l}}\right]</script><script type="math/tex; mode=display">
B_{l-1,\alpha\beta}^{s/p}=\gamma^{s/p}\left[R_{(l-1)l}^{s/p}A_{l,\alpha\beta}^{s/p}e^{j(k_{lz}+k_{(l-1)z})d_{l}}+B_{l,\alpha\beta}^{s/p} e^{-j(k_{lz}-k_{(l-1)z})d_{l}}\right]</script><p>where</p>
<script type="math/tex; mode=display">
\gamma^{s}=\frac{1}{2}\frac{k_{lz}+k_{(l-1)z}}{k_{lz}}=\frac{1}{1-R^{s}_{(l-1)l}}</script><script type="math/tex; mode=display">
\gamma^{p}=\frac{1}{2}\frac{k_{lz}\varepsilon_{l-1}+\varepsilon_{l}k_{(l-1)z}}{k_{(l-1)z}\varepsilon_{l}}=\frac{1}{1+R^{p}_{(l-1)l}},\quad \text {for } \quad \beta=x,y,\quad\alpha=x,y,z</script><script type="math/tex; mode=display">
\gamma^{p}=\frac{1}{2}\frac{k_{lz}\varepsilon_{l-1}+\varepsilon_{l}k_{(l-1)z}}{k_{lz}\varepsilon_{l}}=\frac{k_{(l-1)z}}{k_{lz}}\frac{1}{1+R^{p}_{(l-1)l}},\quad \text {for } \quad \beta=z, \quad\alpha=x,y,z</script><h1 id="The-field-expression-and-emission-pattern"><a href="#The-field-expression-and-emission-pattern" class="headerlink" title="The field expression and emission pattern"></a>The field expression and emission pattern</h1><p>The Green’s tensor can be obtained in previous section, the electric field and magnetic field can be obtained from the Green’s tensor via</p>
<script type="math/tex; mode=display">
\vec{E}(r)=j\omega\mu_0 \boldsymbol{\overset\leftrightarrow{G}}(\boldsymbol{r},\boldsymbol{r}_0)\boldsymbol{p}=j\omega\mu_0 \left(\boldsymbol{\overset\leftrightarrow{I}}+\frac{\nabla \nabla}{k^{2}}\right) G_0(\boldsymbol{r},\boldsymbol{r}_0)\boldsymbol{p}</script><script type="math/tex; mode=display">
\vec{H}(r)=\nabla \times \left(\boldsymbol{\overset\leftrightarrow{G}}(\boldsymbol{r},\boldsymbol{r}_0)\boldsymbol{p}\right)=\nabla \times \left(\boldsymbol{\overset\leftrightarrow{I}}+\frac{\nabla \nabla}{k^{2}}\right) G_0(\boldsymbol{r},\boldsymbol{r}_0)\boldsymbol{p}=\nabla \times G_0(\boldsymbol{r},\boldsymbol{r}_0)\boldsymbol{p}</script><p>And we can write the electric field as</p>
<script type="math/tex; mode=display">
E(r)=\iint \boldsymbol{E}^{s}(k_x,k_y,k_z)+\boldsymbol{E}^{p}(k_x,k_y,k_z)\mathrm{d}k_x\mathrm{d}k_y</script><p>The far field $E_{\infty}$ observed in the direction of the dimensionless unit vector</p>
<script type="math/tex; mode=display">
\boldsymbol{s}=(s_x,s_y,s_z)=(\boldsymbol{\frac{x}{r}},\boldsymbol{\frac{y}{r}},\boldsymbol{\frac{z}{r}})=(\frac{k_x}{k},\frac{k_y}{k},\frac{k_z}{k})</script><p>is determined by the Fourier spectrum $\boldsymbol{E}(k_x,k_y,k_z)$ as $z=0$ as</p>
<script type="math/tex; mode=display">
\boldsymbol{E}_{\infty}(s_x,s_y)=-iks_z \boldsymbol{E}(ks_x,ks_y;0)\frac{e^{ikr}}{r}</script><p>In the far field , the magnetic field vector is transverse to the electric field vector and the time-averaged Poynting vectors is<br>calculated as </p>
<script type="math/tex; mode=display">
\langle \boldsymbol{S}\rangle =\frac{1}{2}\text{Re}\{\boldsymbol{E}\times \boldsymbol{H}\}=\frac{1}{2}\sqrt{\frac{\epsilon_0\varepsilon_l}{\mu_0\mu_l}}(\boldsymbol{E}\cdot \boldsymbol{E}^{*})\cdot\boldsymbol{n}_{r}</script><p>Since the s and p polarized field are orthogonal, then we can express the far field power as</p>
<script type="math/tex; mode=display">
\begin{aligned}
    &\iint \frac{1}{2}\sqrt{\frac{\epsilon_0\varepsilon_l}{\mu_0\mu_l}}(\boldsymbol{E_{\infty}}\cdot \boldsymbol{E_{\infty}}^{*})\cdot\boldsymbol{n}_{r}\cdot r^2\sin\theta \mathrm{d}\theta \mathrm{d}\phi\\
    =&\iint \frac{1}{2}\sqrt{\frac{\epsilon_0\varepsilon_l}{\mu_0\mu_l}}k_z^2 |\boldsymbol{E}(ks_x,ks_y;0)\cdot\boldsymbol{n}_{r}|^2 \cdot \sin\theta \mathrm{d} \theta \mathrm{d}\phi\\
    =& \frac{1}{2}\sqrt{\frac{\epsilon_0\varepsilon_l}{\mu_0\mu_l}}\iint \left(|\boldsymbol{E}|^2_s+|\boldsymbol{E}|^2_p \right)k^2\cos^2\theta \cdot \mathrm{d}\Omega\\
    =& \iint I(\theta,\phi)\mathrm{d}\Omega
\end{aligned}</script><p>where the emission pattern is</p>
<script type="math/tex; mode=display">
I(\theta,\phi)=\frac{1}{2}\sqrt{\frac{\epsilon_0\varepsilon_l}{\mu_0\mu_l}}\left(|\boldsymbol{E}|^2_s+|\boldsymbol{E}|^2_p \right)k^2\cos^2\theta</script><h1 id="Numerical-Implementation"><a href="#Numerical-Implementation" class="headerlink" title="Numerical Implementation"></a>Numerical Implementation</h1><p>Our previous expressions are not suitable for numerical implementation since there are maximum numbers in the exponent. To let is more applicable we rewrite the expressions. We define in the upper space</p>
<script type="math/tex; mode=display">
\widehat{A}_{l,\alpha\beta}^{s/p}=A_{l,\alpha\beta}^{s,p}\exp(jk_{lz}d_{l+1}),\quad \widehat{B}_{l,\alpha\beta}^{s/p}=B_{l,\alpha\beta}^{s,p}\exp(-jk_{lz}d_{l+1})</script><p>and in the lower space</p>
<script type="math/tex; mode=display">
\widehat{A}_{l,\alpha\beta}^{s/p}=A_{l,\alpha\beta}^{s,p}\exp(jk_{lz}d_{l}),\quad \widehat{B}_{l,\alpha\beta}^{s/p}=B_{l,\alpha\beta}^{s,p}\exp(-jk_{lz}d_{l})</script><p>If we use these expression, The green tensor should be</p>
<script type="math/tex; mode=display">
\begin{equation}
\begin{aligned}
G_{\alpha \beta}\left(\mathbf{r}, \mathbf{r}^{\prime}\right)=& \frac{j}{8 \pi^{2}} \iint \mathrm{d} k_{x} \mathrm{d} k_{y} \exp \left\{j\left[k_{x}\left(x-x^{\prime}\right)\right.\right. \\
&\left.\left.+k_{y}\left(y-y^{\prime}\right)\right]\right\} \frac{1}{k_{l z}}\left\{\left[\hat{l}_{\alpha}\left( \pm k_{l z}\right) \widehat{A}_{l, \alpha \beta}^{s} \exp \left(j k_{l z} (z-z_{l})\right)\right.\right. \\
&\left.+\hat{l}_{\alpha}\left(\mp k_{l z}\right) \widehat{B}_{l, \alpha \beta}^{s} \exp \left(-j k_{l z} (z-z_{l})\right)\right] \hat{l}_{\beta}\left(k_{l z}\right) \\
&+\left[\hat{m}_{\alpha}\left( \pm k_{l z}\right) \widehat{A}_{l, \alpha \beta}^{p} \exp \left(j k_{l z} (z-z_{l})\right)\right.\\
&\left.\left.+\hat{m}_{\alpha}\left(\mp k_{l z}\right) \widehat{B}_{l, \alpha \beta}^{p} \exp \left(-j k_{l z} (z-z_{l})\right)\right] \hat{m}_{\beta}\left(k_{l z}\right)\right\}
\end{aligned}
\end{equation}</script><p>where $z_{l}=d_{l+1}$ for $z&gt;z_0$ and $z_{l}=d_{l}$ for $z&lt;z_0$. The coefficients relation between different layers can be rewritten as</p>
<h2 id="In-the-upper-space-1"><a href="#In-the-upper-space-1" class="headerlink" title="In the upper space"></a>In the upper space</h2><script type="math/tex; mode=display">
\widehat{A}_{l+1,\alpha\beta}^{s/p}=\gamma^{s/p}\left[\widehat{A}_{l,\alpha\beta}^{s/p}e^{jk_{lz}(d_{l+1}-d_{l})}+R_{(l+1)l}^{s/p}\widehat{B}_{l,\alpha\beta}^{s/p} e^{-jk_{lz}(d_{l+1}-d_{l})}\right]</script><script type="math/tex; mode=display">
\widehat{B}_{l+1,\alpha\beta}^{s/p}=\gamma^{s/p}\left[R_{(l+1)l}^{s/p}\widehat{A}_{l,\alpha\beta}^{s/p}e^{jk_{lz}(d_{l+1}-d_{l})}+\widehat{B}_{l,\alpha\beta}^{s/p}e^{-jk_{lz}(d_{l+1}-d_{l})}\right]</script><p>where</p>
<script type="math/tex; mode=display">
\gamma^{s}=\frac{1}{2}\frac{k_{lz}+k_{(l+1)z}}{k_{lz}}=\frac{1}{1-R^{s}_{(l+1)l}}</script><script type="math/tex; mode=display">
\gamma^{p}=\frac{1}{2}\frac{k_{lz}\varepsilon_{l+1}+\varepsilon_{l}k_{(l+1)z}}{k_{(l+1)z}\varepsilon_{l}}=\frac{1}{1+R^{p}_{(l+1)l}},\quad \text {for } \quad \beta=x,y,\quad\alpha=x,y,z</script><script type="math/tex; mode=display">
\gamma^{p}=\frac{1}{2}\frac{k_{lz}\varepsilon_{l+1}+\varepsilon_{l}k_{lz}}{k_{lz}\varepsilon_{l+1}}=\frac{k_{(l+1)z}}{k_{lz}}\frac{1}{1+R^{p}_{(l+1)l}},\quad \text {for } \quad \beta=z, \quad\alpha=x,y,z</script><h2 id="In-the-lower-space-1"><a href="#In-the-lower-space-1" class="headerlink" title="In the lower space"></a>In the lower space</h2><script type="math/tex; mode=display">
\widehat{A}_{l-1,\alpha\beta}^{s/p}=\gamma^{s/p}\left[\widehat{A}_{l,\alpha\beta}^{s/p}e^{jk_{lz}(d_{l}-d_{l-1})}+R_{(l-1)l}^{s/p}\widehat{B}_{l,\alpha\beta}^{s/p} e^{-jk_{lz}(d_{l}-d_{l-1})}\right]</script><script type="math/tex; mode=display">
\widehat{B}_{l-1,\alpha\beta}^{s/p}=\gamma^{s/p}\left[R_{(l-1)l}^{s/p}\widehat{A}_{l,\alpha\beta}^{s/p}e^{jk_{lz}(d_{l}-d_{l-1})}+\widehat{B}_{l,\alpha\beta}^{s/p} e^{-jk_{lz}(d_{l}-d_{l-1})}\right]</script><p>where</p>
<script type="math/tex; mode=display">
\gamma^{s}=\frac{1}{2}\frac{k_{lz}+k_{(l-1)z}}{k_{lz}}=\frac{1}{1-R^{s}_{(l-1)l}}</script><script type="math/tex; mode=display">
\gamma^{p}=\frac{1}{2}\frac{k_{lz}\varepsilon_{l-1}+\varepsilon_{l}k_{(l-1)z}}{k_{(l-1)z}\varepsilon_{l}}=\frac{1}{1+R^{p}_{(l-1)l}},\quad \text {for } \quad \beta=x,y,\quad\alpha=x,y,z</script><script type="math/tex; mode=display">
\gamma^{p}=\frac{1}{2}\frac{k_{lz}\varepsilon_{l-1}+\varepsilon_{l}k_{(l-1)z}}{k_{lz}\varepsilon_{l}}=\frac{k_{(l-1)z}}{k_{lz}}\frac{1}{1+R^{p}_{(l-1)l}},\quad \text {for } \quad \beta=z, \quad\alpha=x,y,z</script><h1 id="Relations-of-amplitudes-in-different-layers"><a href="#Relations-of-amplitudes-in-different-layers" class="headerlink" title="Relations of amplitudes in different layers"></a>Relations of amplitudes in different layers</h1><p>In this section , I will complete the derivations of the relations of $G_{\alpha,\beta}$ in different layers. The boundary conditions in each interface can be written as</p>
<script type="math/tex; mode=display">
\widehat{z}\times\left(\mathbf{G}^{+}-\mathbf{G}^{-}\right)=\mathbf{0}</script><script type="math/tex; mode=display">
\widehat{z}\cdot\left(\boldsymbol{\varepsilon}^{+} \mathbf{G}^{+}-\boldsymbol{\varepsilon}^{-}\mathbf{G}^{-}\right)=\mathbf{0}</script><script type="math/tex; mode=display">
\widehat{z}\times\mathbf{\nabla}\times \left(\frac{\mathbf{G}^{+}}{\mu_+}-\frac{\mathbf{G}^{-}}{\mu_{-}}\right)=\mathbf{0}</script><script type="math/tex; mode=display">
\widehat{z}\cdot\mathbf{\nabla} \times\left(\mathbf{G}^{+}-\mathbf{G}^{-}\right)=\mathbf{0}</script><p>For convenience we need write the Green’s tensor into a more simple from which can be used to express the boundary conditions. We can express the total green tensor as</p>
<script type="math/tex; mode=display">
\mathbf{G}=\frac{j}{8 \pi^{2}}\iint \mathrm{d} k_{x} \mathrm{d} k_{y} \exp \left\{j\left[k_{x}\left(x-x^{\prime}\right)+k_{y}\left(y-y^{\prime}\right)\right]\right\}\left[F_{A}\odot A \cdot e^{jk_{lz}z}+F_{B}\odot B \cdot e^{-jk_{lz}z}\right]</script><p>where $F_{A/B}$ is the coefficients before A,B. Since only the component $k_{lz},k_{l}$ is related to material properties, we could write $F_{A/B}$ in a more simple form as </p>
<script type="math/tex; mode=display">
F_{A/B}=U_{A/B}\cdot V_{A/B}</script><p>where $U_{A/B}$ contains only the coefficients without $k_{lz},\varepsilon$. We write the explicit form for each as follows.</p>
<h2 id="S-polarized-light-upper-lower-layer"><a href="#S-polarized-light-upper-lower-layer" class="headerlink" title="S polarized light upper/lower layer"></a>S polarized light upper/lower layer</h2><script type="math/tex; mode=display">
U_{A/B}^{s\uparrow\downarrow}=\frac{1}{\left(k_{x}^{2}+k_{y}^{2}\right)}\left[\begin{array}{ccc}{k_{y}^{2}} & {-k_{x} k_{y}} & {0} \\ {-k_{x} k_{y}} & {k_{x}^{2}} & {0} \\ {0} & {0} & {0}\end{array}\right],V_{A/B}^{s\uparrow\downarrow}=\left[\begin{array}{ccc}{1} & {1} & {1} \\ {1} & {1} & {1}\\ {1} & {1} & {1}\end{array}\right]\frac{1}{k_{lz}}</script><h2 id="P-polarized-light-upper-lower-layer"><a href="#P-polarized-light-upper-lower-layer" class="headerlink" title="P polarized light upper/lower layer"></a>P polarized light upper/lower layer</h2><script type="math/tex; mode=display">
\begin{aligned}
U_{A}^{p\uparrow\downarrow}&=\frac{1}{\left(k_{x}^{2}+k_{y}^{2}\right)}\left[\begin{array}{ccc}{\pm k_{x}^{2} } & \pm {k_{x} k_{y} } & \mp{k_{x}\left(k_{x}^{2}+k_{y}^{2}\right)} \\ 
    \pm {k_{x} k_{y} } & \pm {k_{y}^{2} } & \mp{ k_{y}\left(k_{x}^{2}+k_{y}^{2}\right)} \\ 
    { - k_{x}\left(k_{x}^{2}+k_{y}^{2}\right)} & - { k_{y}\left(k_{x}^{2}+k_{y}^{2}\right)} &  {\left(k_{x}^{2}+k_{y}^{2}\right)^{2} }\end{array}\right]\\
U_{B}^{p\uparrow\downarrow}&=\frac{1}{\left(k_{x}^{2}+k_{y}^{2}\right)}\left[\begin{array}{ccc}{\pm k_{x}^{2} } & \pm {k_{x} k_{y} } & \mp{k_{x}\left(k_{x}^{2}+k_{y}^{2}\right)} \\ 
    \pm {k_{x} k_{y} } & \pm {k_{y}^{2} } & \mp{ k_{y}\left(k_{x}^{2}+k_{y}^{2}\right)} \\ 
    { - k_{x}\left(k_{x}^{2}+k_{y}^{2}\right)} & - { k_{y}\left(k_{x}^{2}+k_{y}^{2}\right)} &  {\left(k_{x}^{2}+k_{y}^{2}\right)^{2} }\end{array}\right]\\
\end{aligned}</script><script type="math/tex; mode=display">
\begin{aligned}
V_{A}^{p\uparrow\downarrow}&=\frac{1}{k_{l}^{2}k_{lz}}\left[\begin{array}{ccc}{ k_{lz}^2} &  {k_{lz}^2} & k_{lz} \\ 
    k_{lz}^2 & k_{lz}^2 & k_{lz} \\ 
    k_{lz} & k_{lz} &  1 \end{array}\right]\\
V_{B}^{p\uparrow\downarrow}&=\frac{1}{k_{l}^{2}k_{lz}}\left[\begin{array}{ccc}{ -k_{lz}^2} &  -{k_{lz}^2} & -k_{lz} \\ 
    -k_{lz}^2 & -k_{lz}^2 & -k_{lz} \\ 
    k_{lz} & k_{lz} &  1 \end{array}\right]\\
\end{aligned}</script><p>Then in deriving the relations of coefficients between different layers, we can only use</p>
<script type="math/tex; mode=display">
\boldsymbol{G}^{'}=V_{A}^{s/p,\uparrow\downarrow} A^{s/p,\uparrow\downarrow} e^{jk_{lz}z}+V_{B}^{s/p,\uparrow\downarrow} B^{s/p,\uparrow\downarrow} e^{jk_{lz}z}</script><p>which is more convenient to write. For convenience, we could also write the Green’s tensor as</p>
<script type="math/tex; mode=display">
\boldsymbol{G}=[\boldsymbol{G}_{1},\boldsymbol{G}_{2},\boldsymbol{G}_{3}]</script><p>so that the boundary conditions can be written as</p>
<script type="math/tex; mode=display">
[-(\boldsymbol{G}^{+}_{2i}-\boldsymbol{G}^{-}_{2i}),(\boldsymbol{G}^{+}_{1i}-\boldsymbol{G}^{-}_{1i}),0]^T=0
    \label{eq75}</script><script type="math/tex; mode=display">
[0,0,(\varepsilon^{+}\boldsymbol{G}^{+}_{3i}-\varepsilon^{-}\boldsymbol{G}^{-}_{3i})]^{T}=0
    \label{eq76}</script><script type="math/tex; mode=display">
\left[-(\partial_z (\boldsymbol{G}_{1i}^{+}/\mu_{+}-\boldsymbol{G}_{1i}^{-}/\mu_{-})-\partial_x (\boldsymbol{G}_{3i}^{+}/\mu_{+}-\boldsymbol{G}_{3i}^{-}/\mu_{-})),\partial_y (\boldsymbol{G}_{3i}^{+}/\mu_{+}-\boldsymbol{G}_{3i}^{-}/\mu_{-})-\partial_z (\boldsymbol{G}_{2i}^{+}/\mu_{+}-\boldsymbol{G}_{2i}^{-}/\mu_{-}),0\right]^T=0
    \label{eq77}</script><script type="math/tex; mode=display">
\left[0,0,\partial_x (\boldsymbol{G}_{2i}^{+}-\boldsymbol{G}_{2i}^{-})-\partial_y (\boldsymbol{G}_{1i}^{+}-\boldsymbol{G}_{1i}^{-})\right]^T=0
    \label{eq78}</script><p>Then </p>
<script type="math/tex; mode=display">
(F_{A2i}^{+}A^{+}_{2i}e^{ik_{z}^{+}z_{0}}+F_{B2i}^{+}B^{+}_{2i}e^{-ik_{z}^{+}z_{0}})-(F_{A2i}^{-}A^{-}_{2i}e^{ik_{z}^{-}z_{0}}+F_{B2i}^{-}B^{-}_{2i}e^{-ik_{z}^{-}z_{0}})=0
\label{Eq:add70}</script><script type="math/tex; mode=display">
(F_{A1i}^{+}A^{+}_{1i}e^{ik_{z}^{+}z_{0}}+F_{B1i}^{+}B^{+}_{1i}e^{-ik_{z}^{+}z_{0}})-(F_{A1i}^{-}A^{-}_{1i}e^{ik_{z}^{-}z_{0}}+F_{B1i}^{-}B^{-}_{1i}e^{-ik_{z}^{-}z_{0}})=0
\label{Eq:add71}</script><script type="math/tex; mode=display">
\varepsilon^{+}(F_{A3i}^{+}A^{+}_{3i}e^{ik_{z}^{+}z_{0}}+F_{B3i}^{+}B^{+}_{3i}e^{-ik_{z}^{+}z_{0}})-\varepsilon^{+}(F_{A3i}^{-}A^{-}_{3i}e^{ik_{z}^{-}z_{0}}+F_{B3i}^{-}B^{-}_{3i}e^{-ik_{z}^{-}z_{0}})=0
\label{Eq:add72}</script><script type="math/tex; mode=display">
\begin{equation}
\begin{aligned}
&\left[ik_{z}^{+}(F_{A1i}^{+}A^{+}_{1i}e^{ik_{z}^{+}z_{0}}-F_{B1i}^{+}B^{+}_{1i}e^{-ik_{z}^{+}z_{0}})/\mu_{+}-ik_{z}^{-}(F_{A1i}^{-}A^{-}_{1i}e^{ik_{z}^{-}z_{0}}-F_{B1i}^{-}B^{-}_{1i}e^{-ik_{z}^{-}z_{0}})/\mu_{-}\right]\\
&-ik_{x}\left[(F_{A3i}^{+}A^{+}_{3i}e^{ik_{z}^{+}z_{0}}+F_{B3i}^{+}B^{+}_{3i}e^{-ik_{z}^{+}z_{0}})/\mu_{+}-(F_{A3i}^{-}A^{-}_{3i}e^{ik_{z}^{-}z_{0}}+F_{B3i}^{-}B^{-}_{3i}e^{-ik_{z}^{-}z_{0}})/\mu_{-}\right]=0
\end{aligned}
\end{equation}
\label{Eq:add73}</script><script type="math/tex; mode=display">
\begin{equation}
\begin{aligned}
&\left[ik_{z}^{+}(F_{A2i}^{+}A^{+}_{2i}e^{ik_{z}^{+}z_{0}}-F_{B2i}^{+}B^{+}_{2i}e^{-ik_{z}^{+}z_{0}})/\mu_{+}-ik_{z}^{-}(F_{A2i}^{-}A^{-}_{2i}e^{ik_{z}^{-}z_{0}}-F_{B1i}^{-}B^{-}_{1i}e^{-ik_{z}^{-}z_{0}})/\mu_{-}\right]\\
&-ik_{y}\left[(F_{A3i}^{+}A^{+}_{3i}e^{ik_{z}^{+}z_{0}}+F_{B3i}^{+}B^{+}_{3i}e^{-ik_{z}^{+}z_{0}})/\mu_{+}-(F_{A3i}^{-}A^{-}_{3i}e^{ik_{z}^{-}z_{0}}+F_{B3i}^{-}B^{-}_{3i}e^{-ik_{z}^{-}z_{0}})/\mu_{-}\right]=0
\end{aligned}
\end{equation}
\label{Eq:add74}</script><p>These equations  are all we have. To get the relations, we need decouple the relations for different rows.</p>
<h3 id="S-polarized-light"><a href="#S-polarized-light" class="headerlink" title="S polarized light"></a>S polarized light</h3><p> We first use the s polarized light as an example. For S polarized light, we have</p>
<script type="math/tex; mode=display">
k_{x}F_{A1i}+k_{y}F_{A2i}=0,k_{x}F_{B1i}+k_{y}F_{B2i}=0,F_{A3i}=F_{B3i}=0</script><p>Then Eq. $\eqref{Eq:add70}$,$\eqref{Eq:add71}$,$\eqref{Eq:add72}$,$\eqref{Eq:add73}$,$\eqref{Eq:add74}$ would be</p>
<script type="math/tex; mode=display">
(A^{+}_{2i}e^{ik_{z}^{+}z_{0}}+B^{+}_{2i}e^{-ik_{z}^{+}z_{0}})/k_{z}^{+}-(A^{-}_{2i}e^{ik_{z}^{-}z_{0}}+B^{-}_{2i}e^{-ik_{z}^{-}z_{0}})/k_{z}^{-}=0</script><script type="math/tex; mode=display">
(A^{+}_{1i}e^{ik_{z}^{+}z_{0}}+B^{+}_{1i}e^{-ik_{z}^{+}z_{0}})/k_{z}^{+}-(A^{-}_{1i}e^{ik_{z}^{-}z_{0}}+B^{-}_{1i}e^{-ik_{z}^{-}z_{0}})/k_{z}^{-}=0</script><script type="math/tex; mode=display">
(A^{+}_{2i}e^{ik_{z}^{+}z_{0}}-B^{+}_{2i}e^{-ik_{z}^{+}z_{0}})/\mu^{+}-(A^{-}_{2i}e^{ik_{z}^{-}z_{0}}-B^{-}_{2i}e^{-ik_{z}^{-}z_{0}})/\mu^{-}=0</script><script type="math/tex; mode=display">
(A^{+}_{1i}e^{ik_{z}^{+}z_{0}}+B^{+}_{1i}e^{-ik_{z}^{+}z_{0}})/\mu^{+}-(A^{-}_{1i}e^{ik_{z}^{-}z_{0}}+B^{-}_{1i}e^{-ik_{z}^{-}z_{0}})/\mu^{-}=0</script><p>Then</p>
<script type="math/tex; mode=display">
A_{\alpha i}^{+}=\frac{k_{z}^{+}\mu_{-}+k_{z}^{-}\mu_{+}}{2k_{z}^{-}\mu_{-}}\left(A_{\alpha i}^{-}e^{i(k_{z}^{-}-k_{z}^{+})z_{0}}+\frac{k_{z}^{+}\mu_{-}-k_{z}^{-}\mu_{+}}{k_{z}^{+}\mu_{-}+k_{z}^{-}\mu_{+}}B_{\alpha i}^{-}e^{-i(k_{z}^{-}-k_{z}^{+})z_{0}}\right)</script><script type="math/tex; mode=display">
B_{\alpha i}^{+}=\frac{k_{z}^{+}\mu_{-}+k_{z}^{-}\mu_{+}}{2k_{z}^{-}\mu_{-}}\left(\frac{k_{z}^{+}\mu_{-}-k_{z}^{-}\mu_{+}}{k_{z}^{+}\mu_{-}+k_{z}^{-}\mu_{+}}A_{\alpha i}^{-}e^{i(k_{z}^{-}-k_{z}^{+})z_{0}}+B_{\alpha i}^{-}e^{-i(k_{z}^{-}-k_{z}^{+})z_{0}}\right)</script><p>So the relation between different layers has been derived and agree well with the reference.</p>
<h3 id="P-polarized-light"><a href="#P-polarized-light" class="headerlink" title="P polarized light."></a>P polarized light.</h3><p>For P polarized light, the relation are more complex. We still substitute the detailed expression into Eq. $\eqref{Eq:add70}$,$\eqref{Eq:add71}$,$\eqref{Eq:add72}$,$\eqref{Eq:add73}$,$\eqref{Eq:add74}$. We still have the following relations</p>
<script type="math/tex; mode=display">
k_{x}F_{A1i}=k_{y}F_{A2i},k_{x}F_{B1i}=k_{y}F_{B2i},</script><p>Still for the relation</p>
<script type="math/tex; mode=display">
(F_{A2i}^{+}A^{+}_{2i}e^{ik_{z}^{+}z_{0}}+F_{B2i}^{+}B^{+}_{2i}e^{-ik_{z}^{+}z_{0}})-(F_{A2i}^{-}A^{-}_{2i}e^{ik_{z}^{-}z_{0}}+F_{B2i}^{-}B^{-}_{2i}e^{-ik_{z}^{-}z_{0}})=0</script><script type="math/tex; mode=display">
(A^{+}_{1i}e^{ik_{z}^{+}z_{0}}+B^{+}_{1i}e^{-ik_{z}^{+}z_{0}})/k_{z}^{+}-(A^{-}_{1i}e^{ik_{z}^{-}z_{0}}+B^{-}_{1i}e^{-ik_{z}^{-}z_{0}})/k_{z}^{-}=0</script><h2 id="Appendix"><a href="#Appendix" class="headerlink" title="Appendix"></a>Appendix</h2><h3 id="Dyadic-Analysis"><a href="#Dyadic-Analysis" class="headerlink" title="Dyadic Analysis"></a>Dyadic Analysis</h3><p>In this section a brief review of dyadic analysis is presented. Dyadic operations and theorems provide an effective tool for manipulation of field quantities. Dyadic notation was first introduced by Gibbs in 1884 which later appeared in literature. Consider a vector function $\vec{F}$ having three scalar component $f_{i}$ with ($i = 1,2,3$) in a Cartesian system, that is</p>
<script type="math/tex; mode=display">
\vec{F}=\sum_{i=1}^{3}f_{i}\hat{x}_{i}</script><p>Now consider three different vector functions  $\vec{F}_{j}$, given by</p>
<script type="math/tex; mode=display">
\vec{F}_{j}=\sum_{i=1}^{3}f_{i,j}\hat{x}_{i},j=1,2,3</script><p>Which constitute a dyad $\overset\leftrightarrow{F}$ given by</p>
<script type="math/tex; mode=display">
\overset\leftrightarrow{F}=[\vec{F}_{1},\vec{F}_{2},\vec{F}_{3}]=\left[\begin{matrix}
f_{11} & f_{12} & f_{13}\\
f_{21} & f_{22} & f_{23}\\
f_{31} & f_{32} & f_{33}\\
\end{matrix}\right]</script><p>It should be emphasized that </p>
<script type="math/tex; mode=display">
\hat{x}_{i}\hat{x}_{j}\neq \hat{x}_{j}\hat{x}_{i} \quad \text{for} i\neq j</script><p>In general a dyad can be formed from the product of two arbitrary vectors  $\vec{a}$ and $\vec{b}$ to form $\overset\leftrightarrow{F}=\vec{a}\vec{b}$ . Components of $\overset\leftrightarrow{F}$ can be obtained from a matrix product of a denoted by a 3 × 1 matrix with 1 × 3 matrix. Note that the converse may not be necessarily true. That is, a general dyad may not be expressiable in terms of product of two vector.</p>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><blockquote id="fn_ref1">
<sup>ref1</sup>. <a href="https://link.aps.org/doi/10.1103/PhysRevE.62.5797" target="_blank" rel="noopener">Accurate and efficient computation of the Green’s tensor for stratified media</a><a href="#reffn_ref1" title="Jump back to footnote [ref1] in the text."> &#8617;</a>
</blockquote>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined" target="_blank" rel="noopener">Knifelee</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="/https:/knifelees3.github.io/2020/06/22/A_En_DipoleInMultiLayerCartesian/">https://knifelees3.github.io/2020/06/22/A_En_DipoleInMultiLayerCartesian/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Python/">Python    </a><a class="post-meta__tags" href="/tags/Physics/">Physics    </a></div><div class="post_share"><div class="social-share" data-image="https://raw.githubusercontent.com/knifelees3/my_pictures/master/picgoup/20200223215829792_1734.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button"><i class="fa fa-qrcode"></i> Donate<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/wechat.jpg"><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/alipay.jpg"><div class="post-qr-code__desc">支付寶</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="next-post pull-full"><a href="/2020/06/21/C_%E6%95%99%E7%A8%8B_%E5%A6%82%E4%BD%95%E8%AE%A9win10%E7%94%B5%E8%84%91%E6%8C%89%E7%99%BE%E5%88%86%E6%AF%94%E6%98%BE%E7%A4%BA%E7%94%B5%E9%87%8F/"><img class="next_cover lazyload" data-src="https://cdn.guidingtech.com/imager/assets/198152/Windows-10-Always-Show-Battery-Percentage-Featured_4d470f76dc99e18ad75087b1b8410ea9.png?1529074864" onerror="onerror=null;src='/img/404.jpg'"><div class="label">Next Post</div><div class="next_info"><span>win10 按百分比显示电量的图标软件</span></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> Recommend</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2019/11/18/A_En_Python_UsefulWeb/" title="Useful python web and sources"><img class="relatedPosts_cover lazyload"data-src="https://raw.githubusercontent.com/knifelees3/my_pictures/master/icons/PythonICON.jpg"><div class="relatedPosts_title">Useful python web and sources</div></a></div><div class="relatedPosts_item"><a href="/2020/06/20/A_En_DipoleEmissionNearSphere/" title="Dipole's Emission Near Sphere"><img class="relatedPosts_cover lazyload"data-src="https://raw.githubusercontent.com/knifelees3/my_pictures/master/picgoup/20200107214942441_16601.png"><div class="relatedPosts_title">Dipole's Emission Near Sphere</div></a></div><div class="relatedPosts_item"><a href="/2019/04/17/A_En_MATLAB_ParallelComputing/" title="MATLAB Parallel Computing Summary"><img class="relatedPosts_cover lazyload"data-src="https://raw.githubusercontent.com/knifelees3/my_pictures/master/icons/MATLABICON.png"><div class="relatedPosts_title">MATLAB Parallel Computing Summary</div></a></div><div class="relatedPosts_item"><a href="/2019/07/23/A_En_Python_PlotStudy1_SemiCircle_OscilatorApprox/" title="Python Plot (1) A small ball on a smooth semicircle (Animated)"><img class="relatedPosts_cover lazyload"data-src="https://raw.githubusercontent.com/knifelees3/my_pictures/master/20190723_Oscilator/pi_6.gif"><div class="relatedPosts_title">Python Plot (1) A small ball on a smooth semicircle (Animated)</div></a></div><div class="relatedPosts_item"><a href="/2019/04/17/A_En_Python_ParallelComputing/" title="Python Parallel Computing Summary"><img class="relatedPosts_cover lazyload"data-src="https://raw.githubusercontent.com/knifelees3/my_pictures/master/icons/PythonICON.jpg"><div class="relatedPosts_title">Python Parallel Computing Summary</div></a></div><div class="relatedPosts_item"><a href="/2019/08/04/A_En_Python_PlotStudy2_ThreeOrthogonalVectors/" title="PythonPlot (2) ThreeOrthogonalVectors"><img class="relatedPosts_cover lazyload"data-src="https://raw.githubusercontent.com/knifelees3/my_pictures/master/20190804_pythonplot2_threevectors/1_view1.png"><div class="relatedPosts_title">PythonPlot (2) ThreeOrthogonalVectors</div></a></div></div><div class="clear_both"></div></div><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i><span> Comment</span></div><div class="vcomment" id="vcomment"></div><script src="https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script><script>var notify = false == true ? true : false;
var verify = false == true ? true : false;
var GUEST_INFO = ['nick','mail','link'];
var guest_info = 'nick,mail,link'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;

window.valine = new Valine({
  el:'#vcomment',
  notify:notify,
  verify:verify,
  appId:'jR8sBuhmF2OQvpAqh8LWCbt1-gzGzoHsz',
  appKey:'2C5ChxH3zGFNoQ8rO7u9I2Lb',
  placeholder:'you can leave your comment here ~',
  avatar:'monsterid',
  guest_info:guest_info,
  pageSize:'10',
  lang:'en',
  recordIP: true
});</script></div></div></div><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2018 - 2020 By Knifelee</div><div class="framework-info"><span>Driven </span><a href="http://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div><div class="footer_custom_text">Any question please email to me: knifelees3@hotmail.com</div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="Read Mode"></i><i class="fa fa-plus" id="font_plus" title="Increase font size"></i><i class="fa fa-minus" id="font_minus" title="Decrease font size"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="Traditional Chinese and Simplified Chinese Conversion" target="_self">繁</a><i class="darkmode fa fa-moon-o" id="darkmode" title="Dark Mode"></i></div><div id="rightside-config-show"><div id="rightside_config" title="Setting"><i class="fa fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="Scroll to comment"><i class="scroll_to_comment fa fa-comments">  </i></a><i class="fa fa-list-ul close" id="mobile-toc-button" title="Table of Contents" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="Back to top" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
    processEscapes: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  },
  CommonHTML: {
    linebreaks: { automatic: true, width: "90% container" }
  },
  "HTML-CSS": { 
    linebreaks: { automatic: true, width: "90% container" }
  },
  "SVG": { 
    linebreaks: { automatic: true, width: "90% container" }
  }
});
</script><script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {
  var all = MathJax.Hub.getAllJax(), i;
  for (i=0; i < all.length; i += 1) {
    all[i].SourceElement().parentNode.className += ' has-jax';
  }
});
</script><script src="https://cdn.jsdelivr.net/npm/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script async src="/js/search/local-search.js"></script><script id="ribbon_piao" mobile="false" src="/js/third-party/piao.js"></script><script src="/js/baidupush.js"> </script><script src="/js/tw_cn.js"></script><script>translateInitilization()
</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async=""></script><script src="/js/third-party/ClickShowText.js"></script><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">Local search</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts"></div></div></div><hr><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>Powered by</span> <a href="https://github.com/wzpan/hexo-generator-search" target="_blank" rel="noopener" style="color:#49B1F5;">hexo-generator-search</a></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></body></html>